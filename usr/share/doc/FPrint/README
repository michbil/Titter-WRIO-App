FPrint for Linux
================
	
	FPrint for Linux is an application designed to manage sales 
	from a text	file to the electronic cash registers (ECR) and
	fiscal printers (FP).

CONTENTS
========
		
	1. Installation
		1.1 Files
		1.2 Usage	
		1.3 Config file
	2. Input / Output file format
	3. Commands and parameters for ECRs
		3.1 Cash registers for Armenia and Romania (old cash registers)
			3.1.1 List of supported commands and parameters of input file
			3.1.2 Sample Input file
		3.2 ECRs for Armenia
			3.2.1 List of commands and parameters for DP 15	
			3.2.2 Samples
	4. Commands and parameters for FPs
		4.1 Fiscal printers for Federation of Bosnia and Herzegovina
			4.1.1 List of commands and parameters for FP 550 and TM-T260F
			4.1.2 Samples
		4.2 Fiscal printers for Moldova
			4.2.1 List of commands and parameters for FP 550 
			4.2.2 Samples
	5. Contacts
		
	
1. Installation
===============
	
	Requires Glibc 2.3.2 and above.
	
	Redhat users can install the application using RPM package:
		
		rpm -i FPrint-X.Y.Z-n.i386.rpm
		
	To install the application to other linux distributions first 
	you need to convert to proper installation format. Debian users
	can use "alien" application:
	
		alien -k name-of-rpm-file.rpm
		dpkg -i name-of-new-created-deb-file.deb
	
1.1 Files
	
	/usr/bin/FPrint
	/usr/bin/FPrintLib.so
	/usr/share/doc/FPrint/FPrint.conf
	/usr/share/doc/FPrint/copyright
	/usr/share/doc/FPrint/EULA
	/usr/share/doc/FPrint/README
	
1.2 Usage

	FPrint config-file
	
1.3 Config file

	For detailed explanation of config parameters please check 
	the sample:
	
	/usr/share/doc/FPrint/FPrint.conf
	
	
2. Input / Output file format
=============================

	The input file contains ASCII text commands. Each line consists
	of only one command. The commands' format is:	
	[command], [logical number], [service field];[parameters]
	
	* [command] field can contains one of the following letters:
  	  S, T, P, C, I, H, F, Y;
	* [logical number] is the number saved in table 2, field 1 of 
	  the ECR; for FP the field is irrelevant, allowed value is 0~99;
	* [service field] consists of 3 sub-fields, each divided by a comma.
  	  In this field FPrint records the result of the respective command
	  execution. In the first lined field, what is recorded is the ECR
	  or FP serial number. The second lined field saves an index from 0
	  to 9 whose value increases with each successful command. The last
	  lined field indicates whether and how a command has been carried
	  out in the following format: 
	  '__': Unprocessed record
 	     0: Operation complete successful
		-1: Invalid application instance
		-2: Com port error
		-3: Data transmit error
		-4: Command execution error
		-5: Data error
		-6: Too much data received
		-7: Checksum error
		-8: Packet timeout expired
		-9: Cash id number mishmashed
		-10: Command is not implemented
		-11: Invalid device id
		-12: Error in command file
		-13: Wrong registration key
		-----------------------------
		Additional errors for FPs
		-----------------------------
		-100: Syntax error
		-101: Command not allowed
        -102: No paper
        -103: Fiscal memory full
		-104: Fiscal memory write error
        -105: Last fiscal recording failed
        -106: Fiscal memory in read-only mode
        -107: Operate error
		
3. Commands and parameters for ECRs
===================================

3.1 Cash registers for Armenia and Romania

3.1.1 List of supported commands and parameters of input file
	
	* [logical number] is logical number of cash register. Not used
      with fiscal printer.
	
	S: Sell of an item
	------------------
	S,[logical number],_____,_,__;[item];[price];[quantity];[stand]; [item group];[tax group];0;0;
	
	* [item] is the name of the item(up to19 symbols for ECR and up 
	  to 20 for FP);
	* [price] is the price of a single item (0 ~ 999999.99 for ECR 
	  and -999999.99 ~ 99999.99 for FP; the negative price is used for 
	  voiding sales);
	* [quantity] is the quantity sold (a number 0 ~ 99999.999);
	* [stand] is the stand number (a number 1 ~ 9);
	* [item group] is the number of the item group (a number 1 ~ 99);
	* [tax group] is the tax group of the item (1 ~ 8 for ECR and 1 ~ 4 
	  for FP);

	T: End of receipt or payment
	----------------------------
	End of receipt:
	T,[logical number],______,_,__;
		
	Payment in cash is made for the whole sum, together with 
	closure of the fiscal receipt.With MP-50 and MP-55 this
	command also closes an official receipt.
		
	Payment:
	T,[logical number],______,_,__;[code];[sum];;;;
	
	* [code] is the payment code: 0,1,2,3, or 4; numbers from
	  0 to 3 correspond to payment in cash, on credit, check 
	  and credit card payment;
	* [sum] is the sum to be paid;

	C: Discount/surcharge in percents
	---------------------------------
	C,[logical number],______,_,__;[type];[percent];;;;
	
	* [type] - one number with a value 0 (surcharge) or 1 
	  (discount);
	* [percent] - the value of the surcharge/discount in
	  percents (0 ~99.99);

	If prior to this command a payment is made with parameter 4,
	a discount/surcharge will be made on the subtotal. Otherwise,
	the discount/surcharge is made on the sum of the last sale.
	MP-50 and MP-55 carry out a discount/surcharge on subtotal
	only. With the FPs this command cannot be executed more than
	once on one and the same sale or subtotal. In this case, Fprint
	will do only the first discount/surcharge and will stop whenever
	it meets an invalid C command.

	P: Print text
	-------------
	P,[logical number],______,_,__;[line 1];[line 2];[line 3];[line 4];[line 5];
	
	* [line 1] .. [line 5] - Text.
	
	If the [line] is empty, it is not printed out. If it contains only
	spaces, it will be printed as an empty line. MP-50 and MP-55 print
	out only the first line. The maximum number of symbols per line is
	24 for ECR and 30 for FP.

	I: Official cash in and cash out of sums
	----------------------------------------	
	I,[logical number],______,_,__;[type];[sum];;;;

	* [type] is 1 number with a 0 value (cash in) or 1 (cash out);
	* [sum] is the sum to be cashed in/cashed out;
	
	F: Allows keyboard input
	------------------------
	F,[logical number],______,_,__;
	
	H: Forbids keyboard input
	-------------------------
	H,[logical number],______,_,__;
	
	Y: Opening of official receipt
	------------------------------	
	Y,[logical number],______,_,__;[line 1]; [line 2];[line 3]; line 4]; line 5];

	* [line 1] .. [line 5] - Text.
	
	An official receipt is opened and only the first line is printed.
	In the official receipt what can be carried out is only the P command
	(printing of text) and the T command (closing the official receipt).

3.1.2 Sample Input file

	S,1,______,_,__;Cabbage;0.05;1.000;1;1;2;0;0;
	S,1,______,_,__;Gherkins;0.05;1.000;1;1;2;0;0;
	C,1,______,_,__;0;10.00;;;;
	S,1,______,_,__;Potatoes;0.02;1.000;1;1;2;0;0;
	S,1,______,_,__;Printer;0.05;3.000;1;1;2;0;0;
	T,1,______,_,__;4;;;;;
	C,1,______,_,__;1;10.00;;;;
	P,1,______,_,__; ;;;;;
	P,1,______,_,__;Is this a fiscal printer;;;;;
	P,1,______,_,__;or a cash register?;;;;;
	P,1,______,_,__; ;;;;;
	T,1,______,_,__;
	I,1,______,_,__;0;1.5;;;;
	I,1,______,_,__;1;1.5;;;;

	Note: Some fiscal devices may not supports all commands.
	
3.2 ECRs for Armenia
	
3.2.1 List of commands and parameters for DP 15	

	Parameters in < > brackets are mandatory, while those in [ ] brackets are non-mandatory! The brackets 
by themselves are not passed along with the data value.

Managing sells
______________

	"38" - open non-fiscal receipt 
	------------------------------
	
		38,1,______,_,__;
		
		The command won't be executed if:
			- there is already opened receipt(fiscal or non-fiscal);
			- the clock is not set;
			- the fiscal memory is not formatted;
		In non-fiscal receipts you can only print non-fiscal text.

	"39" - close non-fiscal receipt
	-------------------------------
	
		39,1,______,_,__;
		
		The command won't be executed if there is no opened receipt.
		
	"42" - print non-fiscal text
	----------------------------

		42,1,______,_,__;[text];
		*[text] is random text (max 30 symbols)
		
		You can print non-fiscal text only in an opened non-fiscal receipt.

	"48" - open fiscal receipt
	--------------------------
	
		48,1,______,_,__;<Operator>;<Password>;<TillNumber>;[Reclamation];
		*<Operator> - operator number (1-30);
		*<Password> - the operator's password (1 to 8 digits);
		*<TillNumber> - till number (max 5 digits);
		*[Reclamation] - One letter "A". If the letter A is present, a "Reclamation" receipt is opened 
		 and all sums by sales are subtracted from the tax registries;

		The answer file contains the following information:
		
		48,1,______,_,__;Total_Receipts,Fiscal_Receipts;
		*Total_Receipts - total number of issued receipts (fiscal and reclamation) since the last fiscal closure;
		*Fiscal_Receipts - total number of issued fiscal receipts (this is the number of the last fiscal receipt);
		
		The command won't be executed if:
			- there is already opened receipt;
			- 24 hours have passed since the last Z report;
			- the fiscal memory is full or corrupted;
			- one of the mandatory parameters is missing or wrong;
			- the operator's password is wrong;
			- the clock is not set;
			- the fiscal journal is full;
			
	"49","52" - sell items
	----------------------

		Both commands are the same, but 52 shows the sale on the display.
		49,1,______,_,__;[item name 1];[item name 2];<Tax group>;<Price>;<Quantity>;[Percent];[Sum];
		*[item name 1, 2] - name of the item 
		*<Price> is the price for the item (you can void sales by passing the same sale with negative price);
		*<quantity> is the quantity to be sold (up to 99999.999);
		*[percent] is the  discount/surcharge in percents (-99.00% ~ 99.00%);
		*[Sum] is the  discount/surcharge by sum (cannot be more then the sum of the sale);
		
		The command won't be executed if:
			- fiscal receipt is not opened;
			- maximum number of sells in a single receipt is reached(120);
			- payment has already started;
			- the sum in one of the tax groups is negative; 		

	"51" - subtotal  
	---------------
		51,1,______,_,__;[Percent];[Sum];
			The command shows the sum of the current sells in the receipt on the display 
		and allows you to make discounts and surcharges on the current sum.
		*[Percent] - discount/surcharge in % (+- 99%);
		*[Sum] - discount/surcharge by sum (discounts cannot be more than the whole sum by sales);
			
			
	"58" - sell programmed items
	-----------------

	The command has 2 variations:
	
		I. 58,1,______,_,__;[+ -]<PLU>;<Departament>;<quantity>;[percent];[sum];
		*[+ -]<PLU> is the PLU number of the item (max 8 digits). If you pass the PLU number with 
		 a minus sign infront of it, the command will cancel the previous sale of that item (the prices 
		 of the sold/canceling items must be the same, the quantity can differ, but cannot go below the 
		 sold quantity);
		*<Departament> - Departament number (1-9), 0 if you dont want to use departaments;
		*<quantity> is the quantity to be sold (a number 0.001 ~ 99999.999);
		*[percent] is the discount/surcharge in percents (-99.00% ~ 99.00%);
		*[sum] is the discount/surcharge by sum;

		

	"53" - payment 
	--------------

		53,1,______,_,__;[text 1];[text 2];[flag];[amount];
		*[text 1];[text 2] - text lines to be printed below the total;
		*[flag] - parameter that determines the type of the payment:
			- value '0' means payment in cash;
			- value '1' means payment via credit;
			- value '2' means payment via debit card;
			- value '3' means payment via check;
			- value '4' means payment via vaucher;
			- value '5' means payment via coupon;
		*[amount] - the sum of the payment

			The parameters [flag] and [amount] are optional and if you skip them, the command will execute 
		payment in cash with the whole sum of the current receipt.

		The command cannot be executed if:
			- there is no opened receipt;
			- the accumulated sum is negative;
			- the sum for a tax group is negative;
			- the display is disconnected;
			
	
	"56" - close fiscal receipt
	---------------------------
	
		56,1,______,_,__;
		The command closes a fiscal receipt, but only if full payment is done.

		The answer file contains the following information:
		56,1,______,_,__;Total_Receipts,Fiscal_Receipts,Reclamation_Receipts;
		*Total_Receipts - total number of issued receipts (fiscal and reclamation) since the last fiscal closure;
		*Fiscal_Receipts - total number of issued fiscal receipts (this is the number of the last fiscal receipt);
		
		
Managing the display
____________________

	
	"33" - clear the display
	------------------------
	
		33,1,______,_,__;
		Clears the display. If there is an opened fiscal receipt and SW4 is OFF, only the bottom row is cleared.
	
	"35" - show text on bottom row of the display
	---------------------------------------------

		35,1,______,_,__;[text];
		*[text] is random text ( 20 symbols max)

	"47" - show text on top row of the display
	------------------------------------------

		47,1,______,_,__;[text];
		*[text] is random text ( 20 symbols max)

		If there is an opened fiscal receipt and SW4 is OFF, the command is rejected.
		
	"63" - show date and time
	-------------------------

		63,1,______,_,__;
		Shows the current date and time on the bottom row of the display(DD.MM.YYYY. HH:MM:SS)
		
	"100" - show text on both rows of the display
	---------------------------------------------

		100,1,______,_,__;[text];
		*[text] is random text (40 symbols max)

		
Reports 
_______


	"73" - fiscal memory report by memory block number
	--------------------------------------------------
	
		73,1,______,_,__;<Start_number>;<End_number>;
		*<Start_number> - digit, defines the starting record number for the report ;
		*<End_number> - digit, defines the ending record number for the report;
		
			
	"79" - fiscal memory report by date
	-----------------------------------
	
		79,1,______,_,__;<Start_date>;<End_date>;
		*<Start_date> - defines the starting date for the report (format DDMMYY);
		*<End_date> - defines the ending date for the report (format DDMMYY);

	"105" - report operators
	------------------------
	
		105,1,______,_,__;
		Prints informations about the sells by operator.

	"111" - report items
	--------------------

		111,1,______,_,__;<Options>;[Start];[End];[Group];
		*<Options> - digit, defines the information to be printed:
			- S - only informations about sold items during the day is printed;
			- P - all programmed items are printed;
		*[Start] - Starting item number to be included in the report;
		*[End] - Ending item number to be included in the report;
		*[Group] - Only items from this stock group will be included in the report;
		
		
Other commands 
______________


	"69" - daily fiscal closure
	---------------------------
	
		69,1,______,_,__;[Type];[N][J];
		*[Type] determines the report type:
			- value '0' means Z report with journal deletion;
			- value '2' means X report without journal deletion;
			
		*[N] - symbol "N" prohibits the deletion of operator's data when Z report (registry clear) is executed;
		*[J] - symbol "J" prints the whole journal before it is deleted;
		
	"70" - internal input and output of cash 
	----------------------------------------

		70,1,______,_,__;[+ -][amount];
		*[+ -][amount] - the sum (max 999999.99) of the input/output (the sign + or - defines if its input or 
		 output);

	"106" - open the drawer
	-----------------------

		106,1,______,_,__;
		
	"107" - programming and deleting items, changing price for programmed items
	---------------------------------------------------------------------------	

		107,1,______,_,__;<operation type>;[set of parameters, depending on the <operation type>];
		
		Depending on the <operation> parameter, the command has 2 different structures:
		I.Programming new items - <operation type> = 1 
			
			107,1,______,_,__;<1>;[Tax group];[PLU];[Group];[Price];[Name];
			*[Tax group] - a number, defining tax groups:
				- 1 : tax group "A";
				- 2 : tax group "B";
				- 3 : tax group "C";
				- 4 : tax group "D";
				- 5 : tax group "E";
				- 6 : tax group "F";
				- 7 : tax group "G";
				- 8 : tax group "H";
			*[PLU] - PLU number of the item 1 - 999999999;
			*[Price] - default price for the item (0.01 - 999999.99);
			*[Group] - stock group (1-9);
			*[Name] - name of the item, max 22 symbols;
						
			The item can be programmed/edited if there is no sells on the PLU or its not programmed.
						
						
		II.Deleting items - <operation type> = 2

			107,[logical number],______,_,__;<2>;[ALL];
			107,[logical number],______,_,__;<2>;[PLU];
			107,[logical number],______,_,__;<2>;[PLU1];[PLU2];
			*[ALL] - if the string "ALL" is passed, the command clears all items;
			*[PLU] - deletes the selected PLU number;
			*[PLU1][PLU2] - deletes selected range from PLU1 to PLU2;
			
		
	
	"300" - loading items from file
	-------------------------------
	
		300,1,______,_,__;<DeleteAll>;<TextOnDisplay>;<File name>;
		*<DeleteAll> - digit, defines if all items are cleared before load:
			- 0 - items in the printer's memory are not cleared; (default value if not specified)
			- 1 - items in the printer's memory are cleared;
		
		*<TextOnDisplay> - text (max 40 symbols), shown on the display while the loading is running;
		*<File name> - string, specifying the location of the file from which the items are loaded;

		Item data structure in the file:  (sample file is included in the installation);
		[Tax group];[PLU];[Group];[Price];[Name]; (this row is just description, do not include it in the file)
		1;1;1;0.01;Test item 01;
		1;2;2;0.02;Test item 02;
		3;3;1;0.03;Test item 03;
		3;4;3;0.04;Test item 04;
		5;5;2;0.05;Test item 05;

			
	"350" - execute custom command
	------------------------------

		350,1,______,_,__;<Input/Output string>;

			You can execute any of the printer's commands (as described in the firmware documentation) by 
		assembling the command number and parameters into a string that you pass in <Input/Output string>.
		The output string will contain the answer packet from the printer(as described in the firmware documentation)
		without the terminators and the control sum (0x01,0x03,BCC).
		

3.2.2 Samples
	
		The samples are contained in the files in folder:
	
		/usr/share/doc/FPrint/Samples/Armenia/
		

4. Commands and parameters for FPs
==================================

4.1 Fiscal printers for Federation of Bosnia and Herzegovina

4.1.1 List of commands and parameters for FP 550 and TM-T260F

	Parameters in < > brackets are mandatory, while those in [ ] brackets are non-mandatory! The brackets 
by themselves are not passed along with the data value.

Managing sells
______________

	"38" - open non-fiscal receipt 
	------------------------------
	
		38,1,______,_,__;
		
		The command won't be executed if:
			- there is already opened receipt(fiscal or non-fiscal);
			- the clock is not set;
			- the fiscal memory is not formatted;
		In non-fiscal receipts you can only print non-fiscal text.

	"39" - close non-fiscal receipt
	-------------------------------
	
		39,1,______,_,__;
		
		The command won't be executed if there is no opened receipt.
		
	"42" - print non-fiscal text
	----------------------------

		42,1,______,_,__;[text];
		*[text] is random text (max 30 symbols)
		
		You can print non-fiscal text only in an opened non-fiscal receipt.

	"48" - open fiscal receipt
	--------------------------
	
		48,1,______,_,__;<IOSA>;<Operator>;<Password>;<TillNumber>;[ReceiptNumber];
		*<IOSA> - IOSA number (max 16 digits);
		*<Operator> - operator number (1-32);
		*<Password> - the operator's password (4 to 8 digits);
		*<TillNumber> - till number (max 5 digits);
		*[ReceiptNumber] - max 6 digits. If present and greater than zero, a "Reclamation" receipt is opened 
		 and this is the number of the receipt from which the warez are returned;

		The answer file contains the following information:
		
		48,1,______,_,__;Total_Receipts,Fiscal_Receipts,Reclamation_Receipts;
		*Total_Receipts - total number of issued receipts (fiscal and reclamation) since the last fiscal closure;
		*Fiscal_Receipts - total number of issued fiscal receipts (this is the number of the last fiscal receipt);
		*Reclamation_Receipts -  total number of issued reclamation receipts;

		The command won't be executed if:
			- there is already opened receipt;
			- the max number of receipts per day is already issued;
			- the fiscal memory is full;
			- the fiscal memory is corrupted;
			- one of the mandatory parameters is missing or wrong;
			- the operator's password is wrong;
			- the clock is not set;
			- the display is not connected;

	"51" - subtotal  
	---------------
		51,1,______,_,__;
		The command shows the sum of the current sells in the receipt on the display.
			
	"52" - sell items
	-----------------

	The command has 2 variations:
	
		I. 52,1,______,_,__;[+ -]<PLU>;[quantity];[percent];
		*[+ -] <PLU> is the PLU number of the item (max 8 digits). If you pass the PLU number with 
		 a minus sign infront of it, the command will cancel the previous sale of that item (the prices 
		 of the sold/canceling items must be the same, the quantity can differ, but cannot go below the 
		 sold quantity);
		*[quantity] is the quantity to be sold (a number 1.000 ~ 99999.999). If you skip this 
		 parameter, the default quantity is used (1.000);
		*[percent] is the  discount/surcharge in percents (-99.00% ~ 99.00% for FP 550, -100% ~ 
		 +100% for TM-T260) ;

		II. 52,1,______,_,__;<VF|VL>;
		*<VF or VL> - void the first sold item in the receipt (VF) or the last item in the receipt (VL);

		The printer will not carry out this command if:
			- the maximum number of sales (99) within a single receipt is already reached;
			- the sum by any of the tax groups is negative;
			- the sum of discounts and surcharges within the receipt is negative;
			- the display is disconnected;

	"53" - payment 
	--------------

		53,1,______,_,__;[flag];[amount];
		*[flag] - parameter that determines the type of the payment:
			- value '0' means payment in cash;
			- value '1' means payment via card;
			- value '2' means payment via cheque;
			- value '3' means payment type Virman";
		*[amount] - the sum of the payment

			The parameters [flag] and [amount] are optional and if you skip them, the command will execute 
		payment in cash with the whole sum of the current receipt.

		The command cannot be executed if:
			- there is no opened receipt;
			- the accumulated sum is negative;
			- the sum for a tax group is negative;
			- the display is disconnected;
			
	"55" - enter client infromation (invoice)
	-----------------------------------------
	
		55,1,______,_,__;<IBK>;<Line 1>;<Line 2>;<Line 3>;[Line 4];[Line 5];[Line 6];
		*<IBK> - exactly 13 symbols - client identification code;
		*<Line 1>,<Line 2>,<Line 3> - up to 36 symbols of text each, the first three lines are mandatory;
		*[Line 4];[Line 5];[Line 6]; - up to 36 symbols of text each, non mandatory parameters;

			The command prints client information (up to 6 lines of text and IBK code). The IBK code and the lines 
		of text after full payment is done, therefor the command won't be executed if full payment is not done.

	"56" - close fiscal receipt
	---------------------------
	
		56,1,______,_,__;
		The command closes a fiscal receipt, but only if full payment is done.

		The answer file contains the following information:
		56,1,______,_,__;Total_Receipts,Fiscal_Receipts,Reclamation_Receipts;
		*Total_Receipts - total number of issued receipts (fiscal and reclamation) since the last fiscal closure;
		*Fiscal_Receipts - total number of issued fiscal receipts (this is the number of the last fiscal receipt);
		*Reclamation_Receipts -  total number of issued reclamation receipts;

		
Managing the display
____________________

	
	"33" - clear the display
	------------------------
	
		33,1,______,_,__;
		Clears the display. If there is an opened fiscal receipt and SW4 is OFF, only the bottom row is cleared.
	
	"35" - show text on bottom row of the display
	---------------------------------------------

		35,1,______,_,__;[text];
		*[text] is random text ( 20 symbols max)

	"47" - show text on top row of the display
	------------------------------------------

		47,1,______,_,__;[text];
		*[text] is random text ( 20 symbols max)

		If there is an opened fiscal receipt and SW4 is OFF, the command is rejected.
		
	"63" - show date and time
	-------------------------

		63,1,______,_,__;
		Shows the current date and time on the bottom row of the display(DD.MM.YYYY. HH:MM:SS)
		
	"100" - show text on both rows of the display
	---------------------------------------------

		100,1,______,_,__;[text];
		*[text] is random text (40 symbols max)

		
Reports 
_______


	"73" - fiscal memory report by memory block number
	--------------------------------------------------
	
		73,1,______,_,__;<Start_number>;<End_number>;<Options>;
		*<Start_number> - digit, defines the starting record number for the report ;
		*<End_number> - digit, defines the ending record number for the report;
		*<Options> - digit, defining the option for the report contents:
			- 0 - prints only the number and datetime for each Z report;
			- 1 - prints total number of issued receipts for each Z report;
			- 2 - prints the total sum for each tax group for each Z report;
			
	"79" - fiscal memory report by date
	-----------------------------------
	
		79,1,______,_,__;<Start_date>;<End_date>;[Start_hour];[End_hour];
		*<Start_date> - defines the starting date for the report (format DDMMYY);
		*<End_date> - defines the ending date for the report (format DDMMYY);
		*[Start_hour] - defines starting hour (if blank the start time is 00:00:00);
		*[End_hour] - defines ending hour (if blank the end time is 23:59:59);

	"105" - report operators
	------------------------
	
		105,1,______,_,__;
		Prints informations about the sells by operator.

	"111" - report items
	--------------------

		111,1,______,_,__;<Options>;
		*<Options> - digit, defines the information to be printed:
			- 0 - only informations about sold items during the day is printed (PLU, Name, Sold quantity) ;
			- 1 - all programmed items are printed (PLU, Name, Price);


Other commands 
______________


	"60" - winter/summer time change
	--------------------------------

		60,1,______,_,__;[Flag];
		*[Flag] - one digit value ( 0 or 1 ):
			- value '0' means winter time change (minus one hour);
			- value '1' means summer time change (plus one hour);
		The command can be executed only 2 times per year!!!

	"69" - daily fiscal closure
	---------------------------
	
		69,1,______,_,__;[Type];[N][A];
		*[Type] determines the report type:
			- value '0' means Z report with registry clear;
			- value '2' means X report without registry clear;
		*[N][A] - the symbols "N" and "A". Description:
			- if symbol "A" is present - the accumulated sold quantities of the items are cleared. The items 
			  themselves are not cleared;
			- if symbol "N" is present - prohibits the deletion of operator's data when Z report (registry clear) 
			  is executed;

	"70" - internal input and output of cash 
	----------------------------------------

		70,1,______,_,__;[+ -][amount];
		*[+ -][amount] - the sum (max 999999.99) of the input/output (the sign + or - defines if its input or 
		 output);

	"106" - open the drawer
	-----------------------

		106,1,______,_,__;
		
	"107" - programming and deleting items, changing price for programmed items
	---------------------------------------------------------------------------	

		107,1,______,_,__;<operation type>;[set of parameters, depending on the <operation type>];
		
		Depending on the <operation> parameter, the command has 3 different structures:
		I.Programming new items - <operation type> = 1 or 2 
			*<operation type> = 1 - duplicate programming is not allowed
			*<operation type> = 2 - duplicate programming is allowed

			107,1,______,_,__;<1|2>;[Tax group];[PLU];[Price];[Name];
			*[Tax group] - a number, defining tax groups:
				- 1 : tax group "A";
				- 2 : tax group "E";
				- 3 : tax group "J";
				- 4 : tax group "K";
				- 5 : tax group "M";
			*[PLU] - PLU number of the item 1 - 65023;
			*[Price] - default price for the item (0.01 - 999999.99);
			*[Name] - name of the item, max 32 symbols;
			
			Can be executed only after fiscal closure.

		II.Deleting items - <operation type> = 3 

			107,[logical number],______,_,__;<3>;[ALL];
			107,[logical number],______,_,__;<3>;[PLU];
			*[ALL] - if the string "ALL" is passed, the command clears all items;
			*[PLU] - deletes the selected PLU number;
			
			Can be executed only after fiscal closure.

		III.Change price - <operation type> = 4 
		
			107,[logical number],______,_,__;<4>;[PLU];[New price];
			*[PLU] - the item number;
			*[New price] - the new price for the item;
		
	"109" - duplicate documents within period or by number of document
	---------------------------------------------------------------

	The command has two variations, depending on the <Cmd> parameter.
	
	I. Date range - <Cmd> parameter = 0: 

		109,1,______,_,__;<Type>;<Start datetime>;<End datetime>;<Cmd>;
		*<Type> - one or more of the following symbols can be passed:
			- A  - prints duplicate for all documents;
			- F - prints duplicate for fiscal receipts;
			- R - prints duplicate for reclamation receipts;
			- Z - prints duplicate for Z reports;
			- X - prints duplicate for X reports;
			- P - prints duplicate for periodic reports;
			e.g. "FZ" means print duplicated fiscal receipts and Z reports.
		*<Start datetime> - start of the period (format DDMMYY[hhmmss]; if [hhmmss] is skipped, default 
		 time is 00:00:00);
		*<End datetime> - end of the period (format DDMMYY[hhmmss]; if [hhmmss] is skipped, default 
		 time is 23:59:59);

	II. Document number - <Cmd> = 1:

		109,1,______,_,__;<Type>;<Start number>;[End number];<Cmd>;
		*<Type> - one of the following symbols can be passed:
			- F - prints duplicate for fiscal receipts;
			- R - prints duplicate for reclamation receipts;
		*<Start number> - start number for range of documents to duplicate. If [End number] is skipped, this 
		 is the number of a single document to be printed;
		*<End number> - end number for the range;


	"300" - loading items from file
	-------------------------------
	
		300,1,______,_,__;[DeleteAll];[AllowDuplicate];[TextOnDisplay];<File name>;
		*[DeleteAll] - digit, defines if all items are cleared before load:
			- 0 - items in the printer's memory are not cleared; (default value if not specified)
			- 1 - items in the printer's memory are cleared;
		*[AllowDuplicate] - digit, defines if item names can be duplicated;
			- 0 - item names cannot be the same; (default value if not specified)
			- 1 - item names can duplicate;
		*[TextOnDisplay] - text (max 40 symbols), shown on the display while the loading is running;
		*<File name> - string, specifying the location of the file from which the items are loaded;

		Item data structure in the file:  (sample file is included in the installation);
		[Tax group];[PLU];[Price];[Name]; (this row is just description, do not include it in the file)
		1;1;0.01;Test item 01;
		1;2;0.02;Test item 02;
		3;3;0.03;Test item 03;
		3;4;0.04;Test item 04;
		5;5;0.05;Test item 05;

	"301" - void receipt
	--------------------
	
		301,1,______,_,__;
	
		Emergency receipt closure. If executed while fiscal receipt is opened, the command voids all sells(if 
	any), executes payment with sum = 0.00 and closes the receipt. Nonfiscal receipts are simply closed.
	The command won't be executed if there is payment already done (with sum > 0) and the payed sum is 
	less that the whole sum of the receipt.


	"305" - custom command - add new item/change price of an existing item and then sell it
	---------------------------------------------------------------------------------------
	
		The command will add new item if none with the specific PLU is found or changes the price of already 
	existing item. After that it will sell the item.

		305,1,______,_,__;<PLU>;[quantity];[percent];[Price];[Tax group>];[Item name];
		*<PLU> is the PLU number of the item (max 8 digits) - If there is already programmed item with that PLU, and the price of that  item differs from <Price>, then the <Price> will be set as new price for the item; 
		If no item with PLU is found, it will be programmed with <PLU>,<Price>,<Tax group> and <Item name>;
		*[quantity] is the quantity to be sold (a number 1.000 ~ 99999.999). If you skip this 
		 parameter, the default quantity is used (1.000);
		*[percent] is the  discount/surcharge in percents (-99.00% ~ 99.00%) ;

		The printer will not carry out this command if:
			- the maximum number of sales (99) within a single receipt is already reached;
			- the sum by any of the tax groups is negative;
			- the sum of discounts and surcharges within the receipt is negative;
			- the display is disconnected;
			- you try to change the price of already sold item within the same receipt;
			
	"350" - execute custom command
	------------------------------

		350,1,______,_,__;<Input/Output string>;

			You can execute any of the printer's commands (as described in the firmware documentation) by 
		assembling the command number and parameters into a string that you pass in <Input/Output string>.
		The output string will contain the answer packet from the printer(as described in the firmware documentation)
		without the terminators and the control sum (0x01,0x03,BCC).
	
4.1.2 Samples

	The samples are contained in the files in folder:
	
		/usr/share/doc/FPrint/Samples_FBaH/
		
	

===================================================================================================================

	
4.2 Fiscal printers for Moldova

4.2.1 List of commands and parameters for FP 550 

	Parameters in < > brackets are mandatory, while those in [ ] brackets are non-mandatory! The brackets 
by themselves are not passed along with the data value.

Managing sells
______________

	"38" - open non-fiscal receipt 
	------------------------------
	
		38,1,______,_,__;
		
		The command won't be executed if:
			- there is already opened receipt(fiscal or non-fiscal);
			- the clock is not set;
			- the fiscal memory is not formatted;
		In non-fiscal receipts you can only print non-fiscal text.

	"39" - close non-fiscal receipt
	-------------------------------
	
		39,1,______,_,__;
		
		The command won't be executed if there is no opened receipt.
		
	"42" - print non-fiscal text
	----------------------------

		42,1,______,_,__;[text];
		*[text] is random text (max 30 symbols)
		
		You can print non-fiscal text only in an opened non-fiscal receipt.

	"48" - open fiscal receipt
	--------------------------
	
		48,1,______,_,__;<Operator>;<Password>;<TillNumber>;
		*<Operator> - operator number (1-32);
		*<Password> - the operator's password (4 to 8 digits);
		*<TillNumber> - till number (max 5 digits);
		
		The answer file contains the following information:
		
		48,1,______,_,__;Total_Receipts,Fiscal_Receipts;
		*Total_Receipts - total number of issued receipts (fiscal and nonfiscal) since the last fiscal closure;
		*Fiscal_Receipts - total number of issued fiscal receipts (this is the number of the last fiscal receipt) since the last fiscal closure;
		
		The command won't be executed if:
			- there is already opened receipt;
			- the max number of receipts per day is already issued;
			- the fiscal memory is full;
			- the fiscal memory is corrupted;
			- one of the mandatory parameters is missing or wrong;
			- the operator's password is wrong;
			- the clock is not set;
		
	"49" - sell items
	-----------------

		49,1,______,_,__;[item name 1];[item name 2];<Tax group>;<Price>;<Quantity>;[Percent];
		*[item name 1, 2] - name of the item 
		*<Price> is the price for the item ()
		*<quantity> is the quantity to be sold (up to 99999.999);
		*[percent] is the  discount/surcharge in percents (-99.00% ~ 99.00%);
		
		The command won't be executed if:
			- fiscal receipt is not opened;
			- maximum number of sells in a single receipt is reached(250);
			- payment has already started;
			- the sum in one of the tax groups is negative;
			- display is disconnected then key 2 is in OFF state;
			
		
	"51" - subtotal  
	---------------
		51,1,______,_,__;<Print>;<Display>;[Percent];
		*<Print> - if passed with value "1", the subtotal will be printed on the receipt;
		*<Display> - if passed with value "1", the subtotal will be shown on the display;
		*[Percent] - custom surcharge or discount on the subtotal sum, ranging from -99.00% to 99.00%;
			
	
	"53" - payment 
	--------------

		53,1,______,_,__;[flag];[amount];
		*[flag] - parameter that determines the type of the payment:
			- value '0' means payment in cash;
			- value '1' means payment via card;
			- value '2' means payment via cheque;
			- value '3' means payment type Virman";
		*[amount] - the sum of the payment

			The parameters [flag] and [amount] are optional and if you skip them, the command will execute 
		payment in cash with the whole sum of the current receipt.

		The command cannot be executed if:
			- there is no opened receipt;
			- the accumulated sum is negative;
			- the sum for a tax group is negative;
			- the display is disconnected;
			
	"55" - enter client infromation (invoice)
	-----------------------------------------
	
		55,1,______,_,__;<IBK>;<Line 1>;<Line 2>;<Line 3>;[Line 4];[Line 5];[Line 6];
		*<IBK> - exactly 13 symbols - client identification code;
		*<Line 1>,<Line 2>,<Line 3> - up to 36 symbols of text each, the first three lines are mandatory;
		*[Line 4];[Line 5];[Line 6]; - up to 36 symbols of text each, non mandatory parameters;

			The command prints client information (up to 6 lines of text and IBK code). The IBK code and the lines 
		of text after full payment is done, therefor the command won't be executed if full payment is not done.

	"56" - close fiscal receipt
	---------------------------
	
		56,1,______,_,__;
		The command closes a fiscal receipt, but only if full payment is done.

		The answer file contains the following information:
		56,1,______,_,__;Total_Receipts,Fiscal_Receipts,Reclamation_Receipts;
		*Total_Receipts - total number of issued receipts (fiscal and reclamation) since the last fiscal closure;
		*Fiscal_Receipts - total number of issued fiscal receipts (this is the number of the last fiscal receipt);
		*Reclamation_Receipts -  total number of issued reclamation receipts;

	"58" - sell programmed items
	----------------------------
	
		58,1,______,_,__;[+ -]<PLU>;[quantity];[percent];
		*[+ -]<PLU> is the plu number of the item to be sold/voided;
		*[quantity] is the quantity to be sold (up to 99999.999);
		*[percent] is the percent discount/surcharge;
		
Managing the display
____________________

	
	"33" - clear the display
	------------------------
	
		33,1,______,_,__;
		Clears the display. If there is an opened fiscal receipt and SW4 is OFF, only the bottom row is cleared.
	
	"35" - show text on bottom row of the display
	---------------------------------------------

		35,1,______,_,__;[text];
		*[text] is random text ( 20 symbols max)

	"47" - show text on top row of the display
	------------------------------------------

		47,1,______,_,__;[text];
		*[text] is random text ( 20 symbols max)

		If there is an opened fiscal receipt and SW4 is OFF, the command is rejected.
		
	"63" - show date and time
	-------------------------

		63,1,______,_,__;
		Shows the current date and time on the bottom row of the display(DD.MM.YYYY. HH:MM:SS)
		
	"100" - show text on both rows of the display
	---------------------------------------------

		100,1,______,_,__;[text];
		*[text] is random text (40 symbols max)

		
Reports 
_______


	"73" - fiscal memory report by memory block number
	--------------------------------------------------
	
		73,1,______,_,__;<Start_number>;<End_number>;
		*<Start_number> - digit, defines the starting record number for the report ;
		*<End_number> - digit, defines the ending record number for the report;
		
			
	"79" - fiscal memory report by date
	-----------------------------------
	
		79,1,______,_,__;<Start_date>;<End_date>;
		*<Start_date> - defines the starting date for the report (format DDMMYY);
		*<End_date> - defines the ending date for the report (format DDMMYY);

	"105" - report operators
	------------------------
	
		105,1,______,_,__;
		Prints informations about the sells by operator.

	"111" - report items
	--------------------

		111,1,______,_,__;<Options>;
		*<Options> - digit, defines the information to be printed:
			- 0 - only informations about sold items during the day is printed (PLU, Name, Sold quantity) ;
			- 1 - all programmed items are printed (PLU, Name, Price);

Other commands 
______________


	"69" - daily fiscal closure
	---------------------------
	
		69,1,______,_,__;[Type];[N];
		*[Type] determines the report type:
			- value '0' means Z report with registry clear, but the registers for service input/output of sums are not printed;
			- value '1' means Z report with registry clear, but the registers for service input/output of sums are printed;
			- value '2' means X report without registry clear, but the registers for service input/output of sums are not printed;
			- value '2' means X report without registry clear, but the registers for service input/output of sums are printed;
		*[N] - symbol "N"  prohibits the deletion of operator's data when Z report (registry clear) is executed;

	"70" - internal input and output of cash 
	----------------------------------------

		70,1,______,_,__;[+ -][amount];
		*[+ -][amount] - the sum (max 999999.99) of the input/output (the sign + or - defines if its input or 
		 output);

	"106" - open the drawer
	-----------------------

		106,1,______,_,__;
		
	"107" - programming and deleting items, changing price for programmed items
	---------------------------------------------------------------------------	

		107,1,______,_,__;<operation type>;[set of parameters, depending on the <operation type>];
		
		Depending on the <operation> parameter, the command has 2 different structures:
		I.Programming new items - <operation type> = 1 
			
			107,1,______,_,__;<1>;[Tax group];[PLU];[Price];[Name];
			*[Tax group] - a number, defining tax groups:
				- 1 : tax group "A";
				- 2 : tax group "B";
				- 3 : tax group "C";
				- 4 : tax group "D";
			*[PLU] - PLU number of the item 1 - 9999;
			*[Price] - default price for the item (0.01 - 999999.99);
			*[Name] - name of the item, max 25 symbols;
						
			The item can be programmed/edited if there is no sells on the PLU or its not programmed.
						
						
		II.Deleting items - <operation type> = 2

			107,[logical number],______,_,__;<2>;[ALL];
			107,[logical number],______,_,__;<2>;[PLU];
			107,[logical number],______,_,__;<2>;[PLU1];[PLU2];
			*[ALL] - if the string "ALL" is passed, the command clears all items;
			*[PLU] - deletes the selected PLU number;
			*[PLU1][PLU2] - deletes selected range from PLU1 to PLU2;
			
		
	
	"300" - loading items from file
	-------------------------------
	
		300,1,______,_,__;<DeleteAll>;<TextOnDisplay>;<File name>;
		*<DeleteAll> - digit, defines if all items are cleared before load:
			- 0 - items in the printer's memory are not cleared; (default value if not specified)
			- 1 - items in the printer's memory are cleared;
		
		*<TextOnDisplay> - text (max 40 symbols), shown on the display while the loading is running;
		*<File name> - string, specifying the location of the file from which the items are loaded;

		Item data structure in the file:  (sample file is included in the installation);
		[Tax group];[PLU];[Price];[Name]; (this row is just description, do not include it in the file)
		1;1;0.01;Test item 01;
		1;2;0.02;Test item 02;
		3;3;0.03;Test item 03;
		3;4;0.04;Test item 04;
		5;5;0.05;Test item 05;

			
	"350" - execute custom command
	------------------------------

		350,1,______,_,__;<Input/Output string>;

			You can execute any of the printer's commands (as described in the firmware documentation) by 
		assembling the command number and parameters into a string that you pass in <Input/Output string>.
		The output string will contain the answer packet from the printer(as described in the firmware documentation)
		without the terminators and the control sum (0x01,0x03,BCC).
	
4.2.2 Samples

	The samples are contained in the files in folder:
	
		/usr/share/doc/FPrint/Samples/Moldova/
		
	
5. Contacts
===========
	email: support@datecs.bg
	web: www.datecs.bg
	
Copyright
=========
© 2009 - Datecs Ltd. All rights reserved
	